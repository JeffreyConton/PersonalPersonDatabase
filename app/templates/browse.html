<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Browse People</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="navigation">
            <h2>Navigation</h2>
            <ul>
                <li><a href="{{ url_for('home') }}">Home</a></li>
                <li><a href="{{ url_for('browse') }}">Browse People</a></li>
                <li><a href="{{ url_for('add_or_edit') }}">Add Person</a></li>
            </ul>
        </div>
        <div class="content">
            <h2>Browse People</h2>
            <div class="search-container">
                <input type="text" class="search-bar" id="searchBar" placeholder="Search by name, nickname, etc.">
                <div class="filter-options">
                    <label for="genderFilter">Gender:</label>
                    <select id="genderFilter">
                        <option value="">All</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                    <label for="occupationFilter">Occupation:</label>
                    <input type="text" id="occupationFilter" placeholder="Occupation">
                </div>
            </div>
            <div class="person-grid" id="personGrid">
                {% for person in people.items %}
                    <div class="person-card" data-name="{{ person.full_name }}" data-gender="{{ person.gender }}" data-occupation="{{ person.occupation }}">
                        {% if person.image_url %}
                            <img src="{{ person.image_url }}" alt="{{ person.full_name }}" class="person-image">
                        {% endif %}
                        <h3>{{ person.full_name }}</h3>
                        <p><i class="fas fa-id-badge"></i> Nickname: {{ person.nickname }}</p>
                        <p><i class="fas fa-venus-mars"></i> Gender: {{ person.gender }}</p>
                        <p><i class="fas fa-briefcase"></i> Occupation: {{ person.occupation }}</p>
                        <p><i class="fas fa-calendar-alt"></i> Date of Birth: {{ person.date_of_birth }}</p>
                        <p><i class="fas fa-map-marker-alt"></i> Place of Birth: {{ person.place_of_birth }}</p>
                        <p><i class="fas fa-flag"></i> Nationality: {{ person.nationality }}</p>
                        <p><i class="fas fa-home"></i> Address: {{ person.address }}</p>
                        <p><i class="fas fa-phone"></i> Phone Number: {{ person.phone_number }}</p>
                        <p><i class="fas fa-envelope"></i> Email Address: {{ person.email_address }}</p>
                        <a href="{{ url_for('add_or_edit', id=person.id) }}">Edit</a>
                        <form action="{{ url_for('delete', id=person.id) }}" method="post" style="display:inline;">
                            <button type="submit">Delete</button>
                        </form>
                    </div>
                {% endfor %}
            </div>
            <div class="pagination">
                {% if people.has_prev %}
                    <a href="{{ url_for('browse', page=people.prev_num) }}">&laquo; Prev</a>
                {% endif %}
                {% if people.has_next %}
                    <a href="{{ url_for('browse', page=people.next_num) }}">Next &raquo;</a>
                {% endif %}
            </div>
        </div>
    </div>
    <script>
        const searchBar = document.getElementById('searchBar');
        const genderFilter = document.getElementById('genderFilter');
        const occupationFilter = document.getElementById('occupationFilter');

        function filterCards() {
            const searchQuery = searchBar.value.toLowerCase();
            const genderQuery = genderFilter.value;
            const occupationQuery = occupationFilter.value.toLowerCase();

            document.querySelectorAll('.person-card').forEach(card => {
                const name = card.getAttribute('data-name').toLowerCase();
                const gender = card.getAttribute('data-gender');
                const occupation = card.getAttribute('data-occupation').toLowerCase();

                const matchesSearch = name.includes(searchQuery);
                const matchesGender = !genderQuery || gender === genderQuery;
                const matchesOccupation = !occupationQuery || occupation.includes(occupationQuery);

                if (matchesSearch && matchesGender && matchesOccupation) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        searchBar.addEventListener('input', filterCards);
        genderFilter.addEventListener('change', filterCards);
        occupationFilter.addEventListener('input', filterCards);
    </script>
</body>
</html>